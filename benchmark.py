#! /usr/bin/env python
import subprocess
from subprocess import Popen, call
import time

storage = Popen('./mdps')
leader = Popen('./mdpl')
worker = Popen('./mdpw')

#sleep(1)

genome_files = '''
1a0cA_1a0dA
1a0cA_1bxbD
1a0cA_1ubpC
1a0fA_1hqoA
1a0fA_1ljrA
1a0fA_1pd21
1a0hA_5hpgA
1a0p_1a36A
1a0p_1ae9A
1a0tP_2mprA
1a1z_1d2zA
1a02N_1a3qA
1a2vA_1ksiB
1a3aA_1a6jA
1a3c_1tc1A
1a3k_1c1lA
1a3k_1lcl
1a3qA_1gof
1a04A_1dz3A
1a04A_1ibjA
1a04A_3chy
1a4iA_1b0aA
1a4iA_1ee9A
1a6cA_1bmv1
1a6dA_1ass
1a6dA_1derA
1a6jA_1hynP
1a6l_2fdn
1a6m_1ash
1a6m_1cg5B
1a6m_1ewaA
1a6m_1flp
1a6m_1h97A
1a6m_1hlb
1a6m_1ithA
1a6m_2fal
1a6m_2gdm
1a6m_2hbg
1a6m_2vhbA
1a6m_3sdhA
1a6o_1buhA
1a7s_1agjA
1a7s_2cgaB
1a7tA_1e5dA
1a7tA_1smlA
1a7w_1aoiA
1a7w_1aoiB
1a7w_1b67B
1a7w_1bh9B
1a7w_1tafA
1a7w_1tafB
1a8d_1wba
1a8h_1qqtA
1a8l_1hyuA
1a8o_1qrjB
1a8rA_1fb1D
1a9nA_1dceA
1a12A_1jtdB
1a28A_2prgA
1a28A_3erdA
1a36A_1a41
1a44_1qouB
1a49A_1dxeA
1a49A_1pkyC
1a49A_2tpsA
1a53_1dvjA
1a53_1hg3A
1a53_1nsj
1a53_1qo2A
1a62_1mjc
1a65A_1aozA
1a65A_1nif
1a75A_1b8cB
1aba_1h75A
1aba_1kte
1aba_1qfnA
1aba_3grx
1abrB_1dqgA
1abwA_1cqxA
1ac5_1auoA
1ac5_1cpy
1ad3A_1bpwA
1ad3A_1euhA
1adeA_1dj3A
1adjA_1atiA
1adjA_1httD
1ae9A_1a36A
1ae9A_1aihA
1aerA_1aerB
1ag4_1amm
1agdA_1bqsA
1agdA_1iakA
1agdB_1iakA
1agjA_1cqqA
1agqA_1vpfA
1ah1_1cid
1ah1_1f97A
1ah1_1kb5B
1ah1_1qfoA
1ah1_1tlk
1ah1_1vcaA
1ah1_2ncm
1ah7_1ca1
1ah9_1bkb
1aihA_1a0p
1air_1pcl
1aisB_1guxB
1aj6_1b63A
1aj8A_1csh
1ajqA_1cp9A
1ajqB_1nedA
1ajsA_1aam
1ajsA_1ibjA
1ak1_1hrkA
1ako_1bix
1alu_1bgc
1alu_1cnt3
1alu_1i1rB
1aly_1d4vB
1aly_1dyoA
1aly_2tnfA
1am2_1at0
1am7A_3lzt
1amj_1zymA
1amk_1hg3A
1amoA_1ddgB
1amoA_1ep2B
1amoA_1fnc
1amoA_1qfjA
1amoA_1rcf
1amp_1b8oA
1amp_1cg2A
1amp_1cx8B
1amp_1xjo
1amuA_1lci
1an8_1aw7A
1an8_1eu4A
1an8_1f77B
1an9A_1c0pA
1aoa_1bkrA
1aocA_1bndA
1aoeA_1d1gA
1aoeA_1vdrA
1aoeA_3dfr
1aohA_1anu
1aohA_1g1kB
1aoiA_1bh9B
1aoiA_1tafA
1aoiB_1a7w
1aoiB_1aoiD
1aoiB_1jfiB
1aoiB_1tafA
1aoiC_1f66G
1aoiD_1aoiB
1aoiD_1jfiB
1aoxA_1atzA
1aoxA_1auq
1aoxA_1ido
1aoy_1b4aA
1ap0_1dz1A
1ap8_1ejhA
1apyA_1ayyC
1apyB_2gawD
1aq0A_1eokA
1aq0A_1ghsB
1aqb_1avgI
1aqb_1bebA
1aqb_1epaA
1aqb_1h91A
1aqt_1e79H
1aquA_1fmlB
1aqzA_1de3A
1aqzA_9rnt
1arb_2hrvA
1ash_1a6m
1ash_1flp
1ash_1ithA
1ash_2fal
1at3A_1fl1A
1at3A_1lay
1atg_1ixh
1atg_1mrp
1atg_1wod
1atiA_1g5hA
1atiA_1qf6A
1atlA_1bkcA
1atzA_1auq
1atzA_1ido
1atzA_2scuB
1au7A_2hddA
1auiB_1dguA
1auk_1fsu
1auoA_1brt
1auoA_1fj2B
1auoA_1i6wA
1auoA_1jfrA
1auq_1ido
1auvA_1iow
1auyA_1e57B
1auyA_1qqp3
1auz_1dciA
1avaC_1wba
1avgI_1epaA
1avmA_3mdsA
1avpA_1euvA
1aw0_1cc8A
1aw8B_1cr5A
1awcA_1bc8C
1awcA_2hts
1awcA_2irfG
1awd_1ayfA
1awe_1btkA
1awe_1dbhA
1awe_1faoA
1awe_1pls
1ax4A_2dkb
1ax4A_2tplA
1ax8_1f6fA
1ax8_1rcb
1axiB_1bp3B
1axiB_1j7vR
1axkA_2nlrA
1aye_1qmuA
1ayfA_1put
1aym1_2hwf1
1aym2_1hri2
1aym2_1qqp2
1aym3_1b35A
1aym3_1ihmA
1aym3_1rud3
1az9_1bn5
1az9_1c24A
1azpA_1bf4A
1azsA_1culB
1azsA_1fx2A
1b0nA_1r69
1b0uA_1jj7A
1b0uA_1skyE
1b2pA_1msaA
1b3aA_1hfgA
1b3aA_1tvxA
1b3jA_1agdA
1b3mA_1b8sA
1b4kA_1qmlA
1b5fB_1smrA
1b5l_1rmi
1b6cB_1ia8A
1b6e_1fm5A
1b6e_1hyrB
1b6g_1bn6A
1b6g_1cqwA
1b6rA_1gsoA
1b6tA_1f9aA
1b7eA_1f3iA
1b7fA_1b64
1b7gO_1drw
1b7gO_1gcuA
1b7gO_1ofgA
1b8aA_1aszA
1b8aA_1lylA
1b8gA_1bjwA
1b8gA_1bw0A
1b8gA_1iaxA
1b8oA_1cb0A
1b8xA_1pd21
1b8xA_1pgtA
1b9hA_1ibjA
1b9lA_1dhn
1b9yC_1a0rP
1b9zA_1a49A
1b16A_1bdb
1b16A_1bsvA
1b16A_1e6wA
1b16A_1fds
1b16A_1he2A
1b16A_1xel
1b16A_1ybvA
1b16A_3chy
1b20A_1rgeA
1b25A_1aorA
1b34B_1d3bA
1b34B_1d3bB
1b34B_1i8fA
1b35A_1b35B
1b35A_1ihmA
1b35A_2mev1
1b37B_1gpeA
1b64_1fjfJ
1b87A_1i21A
1b93A_1g8mA
1ba1_1dkgD
1ba1_1glcG
1bag_1smd
1bak_1btkA
1bak_1btn
1bak_1dynA
1bak_1faoA
1bak_1mai
1bb9_2semA
1bbhA_1jafB
1bbhA_2ccyA
1bbzA_1ckaA
1bbzA_1gcpA
1bcfA_1dpsA
1bcfA_1eumA
1bcfA_1qghA
1bcfA_2fha
1bcpA_1lt3A
1bcpD_1prtF
1bcpD_1tiiD
1bcpD_3chbD
1bd3A_1dkuA
1bd3A_1nulA
1bdb_1cydA
1bdb_1e6wA
1bdb_1e7wA
1bdb_1hdcA
1bdb_1oaa
1bdb_1ybvA
1bdo_1ghj
1bdo_1iyu
1bdyA_1rlw
1be3A_1be3B
1be3A_1ezvA
1be3A_1ezvB
1be3A_1hr6A
1be3B_1bccB
1be3B_1ezvB
1be3B_1hr6A
1be3C_3bccC
1bebA_1bj7
1bebA_1epaA
1bebA_1mup
1bec_1iakB
1bec_1tvdA
1bec_3mcg1
1befA_1jxpA
1befA_2hrvA
1bf2_1ehaA
1bfd_1d4oA
1bfg_1afcH
1bfg_1jlyA
1bg2_1f9tA
1bglA_1bhgA
1bh9B_1jfiB
1bh9B_1tafA
1bhe_1czfA
1bhe_1rmg
1bhgA_1qnoA
1bhtA_5hpgA
1bi0_1fx7B
1bi0_1smtA
1bi5A_1dd8A
1bi5A_1hn9A
1bif_1qhfA
1bj4A_1bjwA
1bj7_1epaA
1bj7_1obpA
1bjnA_1bt4A
1bjwA_1bw0A
1bjwA_1cl2A
1bjwA_1d2fA
1bjx_1qgvA
1bk5A_1ialA
1bk7A_1bolA
1bkjA_1f5vA
1bkjA_1vfrA
1bkpA_1tlcA
1bkrA_1aoa
1bkrA_1bhdA
1bli_1jdc
1bm9A_1cf7B
1bmdA_1b8pA
1bmdA_1ceqA
1bmdA_1hyhA
1bmdA_2cmd
1bmfG_1mabG
1bmlC_1qqrC
1bn5_1c24A
1bn6A_1cv2A
1bndA_1aocA
1bndA_1nt3A
1bo4A_1cjwA
1bo4A_1i21A
1bob_1qsmA
1bob_1yghA
1bolA_1bk7A
1booA_1eg2A
1boy_1a21A
1bp7A_1af5
1bpi_1brcI
1bpv_1bquA
1bpv_2fnbA
1bpwA_1euhA
1bpwA_1eyyA
1bqcA_7a3hA
1bqg_1ec7B
1bqg_1mucA
1bqg_1qumA
1bqg_2mnr
1bqk_2mtaA
1bqsA_1cvsC
1bquA_1bj8
1br9_1d2bA
1br9_1jc7A
1brmA_1drw
1brmA_1gcuA
1brmA_1qrrA
1brt_1i6wA
1brt_1jfrA
1brt_1qlwA
1bs0A_1b8gA
1bs0A_1elqA
1bs9_1cex
1bs9_1ei9A
1bsvA_1bwsA
1bsvA_1bxkA
1bsvA_1he2A
1bsvA_1xel
1bt3A_1lla
1btkA_1btn
1btkA_1dynA
1btkA_1faoA
1btkA_1pls
1btkA_1rrpB
1btl_1e25A
1btl_1ei5A
1btl_1omeB
1btl_1skf
1btn_1dynA
1btn_1mai
1btn_1pls
1btn_1qqgA
1btn_1rrpB
1bu2A_1g3nC
1bu2A_1vin
1bu7A_1ea1A
1burA_1rusB
1bv1_1em2A
1bv1_3pmgA
1bvwA_1dysA
1bvwA_1tml
1bvzA_1cxlA
1bvzA_1ehaA
1bvzA_1smaA
1bvzA_7taa
1bw0A_1d2fA
1bw9A_1qorA
1bw9A_1qp8A
1bx4A_1dgyA
1bx4A_1rkd
1bxkA_1db3A
1bxkA_1eq2A
1bxkA_1he2A
1bxkA_1xel
1byb_1fa2A
1byfA_1esl
1byfA_1fm5A
1byfA_1htn'''
genome_files_list = map(lambda x: x.strip(), genome_files.split())

for x in range(len(genome_files_list)):
    print('uploading genome')
    call(['./mdpc','genome','upload', 'data/'+genome_files_list[x], 'genome_'+str(x)])

time.sleep(4)
print(' done uploading genomes?? I think...')
inflights = set()
for first in range(len(genome_files_list)):
    for second in range(len(genome_files_list)):
        inflights.add(Popen(['./mdpc', 'local-align', 'genome_' + str(first), 'genome_' + str(second)]))
for obj in inflights:
    obj.wait()
worker.kill()
leader.kill()
storage.kill()
